# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0

name                gds
version             2.19.6
revision            0

categories          science
platforms           darwin
license             GPL
maintainers         {@emaros ligo.org:ed.maros} openmaintainer

description         LSC Algorithm Library
long_description    LIGO Scientific Collaboration Algorithm Library containing core \
                    routines for gravitational wave data analysis.

homepage            https://git.ligo.org/gds/gds
master_sites        https://software.igwn.org/lscsoft/source/

checksums           rmd160  5d6b8f06b8627a53072ea9c9f649a76540128af8 \
                    sha256  c89a764cbaabe9c2d34caa5a9ee53cff659bf8e6d7c7eaef9cc54041b507a5a7 \
                    size    1911431

depends_build-append \
                    port:pkgconfig

depends_lib-append  port:curl \
                    port:expat \
                    port:fftw-3 \
                    port:fftw-3-single \
                    port:jsoncpp \
                    port:ldas-tools-framecpp \
                    port:metaio

use_autoreconf      yes
use_automake        yes

#------------------------------------------------------------------------
# The MacPorts version of sasl2 leads to a 5 minute latency for each
# socket connection.
#------------------------------------------------------------------------
configure.args-append \
                    --includedir=${prefix}/include/gds \
                    --enable-dtt \
                    --without-sasl \
                    --with-jsoncpp=${prefix}

#------------------------------------------------------------------------
# Use C++ 2014 for High Sierra and beyond else C++ 2011
#------------------------------------------------------------------------
if {${os.platform} eq "darwin" && ${os.major} >= 17 } {
    compiler.cxx_standard   2014
} else {
    compiler.cxx_standard   2011
}

livecheck.type   regex
livecheck.url    ${master_sites}
livecheck.regex  {gds-(\d+(?:\.\d+)*).tar.gz}
